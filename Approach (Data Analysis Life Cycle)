## Analysis Notebook â€“ analysis/analysis.ipynb

# Card Issuance Analysis per RM

import pandas as pd

# Load data
data = pd.read_csv('../data/Card_Issuance_Master.csv')

# Calculate quarterly totals per RM
quarterly = data.groupby('RM_Name').agg(
    Total_Cards=('Cards_Issued', 'sum')
).reset_index()

# Calculate % achievement
quarterly['% Achievement'] = (quarterly['Total_Cards'] / 750) * 100

# Variance vs target
quarterly['Variance'] = quarterly['Total_Cards'] - 750

# Display summary
print("Quarterly RM Performance:")
print(quarterly)

# Monthly pivot table
monthly_pivot = data.pivot_table(
    index='RM_Name',
    columns='Month',
    values='Cards_Issued',
    aggfunc='sum'
).reset_index()

print("\nMonthly Breakdown per RM:")
print(monthly_pivot)

# Optional: save summary to Excel
quarterly.to_excel('../data/Quarterly_RM_Summary.xlsx', index=False)
